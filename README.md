# FastAPI Receipts API

Простой API для управления чеками продаж с использованием FastAPI, SQLAlchemy и Pydantic.  

## Установка  

Убедитесь, что у вас установлен Python.(Использовал Python3.9)

Клонируйте репозиторий:  
git clone https://github.com/K-Ihor/API_Bill  

Перейдите в каталог проекта:  
Создайте виртуальное окружение и установите зависимости:  
pip install -r requirements.txt

## Настройка базы данных и переменных окружения  

Шаг 1: Создание базы данных
Создайте две базы данных: одну для API и другую для тестов.  
Пример команды для создания базы данных в PostgreSQL:

CREATE DATABASE test_db1;  
CREATE DATABASE test_db;

### Шаг 2: Создание файла .env

Создайте файл .env в корне вашего проекта и  
добавьте следующие переменные окружения:

### Переменные для API
DATABASE_URL=postgresql://admin:admin@localhost/test_db

### Переменные для тестов
TEST_DATABASE_URL=postgresql://admin:admin@localhost/test_db1

### Секретный ключ для JWT (замените "secret_key" на ваш собственный ключ либо оставьте таким же)
SECRET_KEY=secret_key


## Шаг 3: Запуск API
Теперь, при запуске вашего API,  
он будет использовать эти переменные окружения для подключения к базе данных.  

Запустите приложение:  
uvicorn main:app --reload  

Откройте Swagger UI или ReDoc для взаимодействия с API.  

 Swagger UI http://localhost:8000/docs  
 ReDoc http://localhost:8000/redoc    
 

## Функционал  

API предоставляет следующие возможности:  

Регистрация нового пользователя (/register) 

Получение токена для аутентификации (/token)  

Создание чека продажи (/create_receipt)   

Получение списка чеков пользователя с возможностью фильтрации (/receipts)  

Просмотр отформатированного текста чека по его идентификатору (/receipts/{receipt_id}/view)  

Дополнительные детали по использованию каждого эндпоинта можно найти в Swagger UI.  


## Конфигурация вида чека  

При просмотре отформатированного текста чека можно настроить количество символов в строке, передав параметр chars в запрос.  

Пример использования:    

curl -X GET "http://127.0.0.1:8000/receipts/1/view?chars=50" -H "accept: text/plain"  
